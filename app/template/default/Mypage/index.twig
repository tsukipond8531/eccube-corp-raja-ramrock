{#
This file is part of EC-CUBE

Copyright(c) EC-CUBE CO.,LTD. All Rights Reserved.

http://www.ec-cube.co.jp/

For the full copyright and license information, please view the LICENSE
file that was distributed with this source code.
#}
{% extends 'default_frame.twig' %}

{% set mypageno = 'index' %}

{% set body_class = 'mypage' %}

{% block stylesheet %}
    <style>
        .customer_info {
            margin: 10px 0 25px;
        }
        .customer_info .title {
            margin-bottom: 15px;
        }
        .customer_info table {
            width: 100%;
        }
        .customer_info table,
        .customer_info tr,
        .customer_info th {
            border: 1px solid #ddd;
        }
        .cancelled {
            background: #eee;
        }
        .ec-historyRole .ec-historyRole__contents {
            padding: 10px;
        }
        @media only screen and (max-width: 767px) {
            .customer_info th {
                width: 100px;
                padding: 5px 0 5px 10px;
                font-size: 15px;
            }
            .customer_info td {
                padding: 5px 10px;
            }
        }
        @media only screen and (min-width: 768px) {
            .customer_info th,
            .customer_info td {
                padding: 10px 20px;
            }
        }
    </style>
{% endblock stylesheet %}

{% block main %}
<div class="ec-modifiedLayoutRole__contents">
    <div class="ec-layoutRole__main">
        <div class="ec-mypageRole">
            <div class="ec-pageHeader">
                <h1>{{ 'マイページ'|trans }}/{{ 'ご注文履歴'|trans }}</h1>
            </div>
            {% include 'Mypage/navi.twig' %}
        </div>
        <div class="ec-mypageRole">
            <div class="customer_info">
                <h2 class="title">お客様情報</h2>
                <table>
                    <tr>
                        <th>会員ID</th>
                        <td>{{ Customer.id }}</td>
                    </tr>
                    <tr>
                        <th>お名前</th>
                        <td>{{ Customer.name01 }}　{{ Customer.name02 }}</td>
                    </tr>
                    <tr>
                        <th>お名前（フリガナ）</th>
                        <td>{{ Customer.kana01 }}　{{ Customer.kana02 }}</td>
                    </tr>
                    <tr>
                        <th>住所</th>
                        <td>
                            〒{{ Customer.postal_code }}<br />
                            {{ Customer.Pref.name }}{{ Customer.addr01 }}{{ Customer.addr02 }}
                        </td>
                    </tr>
                    <tr>
                        <th>電話番号</th>
                        <td>{{ Customer.phone_number }}</td>
                    </tr>
                    <tr>
                        <th>メールアドレス</th>
                        <td>{{ Customer.email }}</td>
                    </tr>
                    <tr>
                        <th>生年月日</th>
                        <td>{{ Customer.birth|date('Y年m月d日') }}</td>
                    </tr>
                </table>
            </div>
            {% if pagination.totalItemCount > 0 %}
                {# <p class="ec-para-normal">{{ '%count%件の履歴があります'|trans({'%count%':pagination.totalItemCount}) }}</p> #}
                <h2 class="ec-para-normal" style="margin: 30px 0 10px; color: brown;">今月の請求金額： {{ totalPrice|price }}</h2>
                {% for Order in pagination %}
                    <div class="ec-historyRole {% if Order.OrderStatus.id == 3 %}cancelled{% endif %}">
                        <div class="ec-historyRole__contents">
                            <div class="ec-historyRole__header">
                                <div class="ec-historyListHeader">
                                    <p class="ec-historyListHeader__date">{{ Order.order_date|date_sec }}</p>
                                    <dl class="ec-definitions">
                                        <dt>{{ 'ご注文番号'|trans }}</dt>
                                        <dd>{{ Order.order_no }}</dd>
                                    </dl>
                                    {% if (BaseInfo.option_mypage_order_status_display) %}
                                        <dl class="ec-definitions">
                                            <dt>{{ 'ご注文状況'|trans }}</dt>
                                            <dd>{{ Order.CustomerOrderStatus }}</dd>
                                        </dl>
                                    {% endif %}
                                    <p class="ec-historyListHeader__action">
                                        <a class="ec-inlineBtn" href="{{ url('mypage_history', {'order_no': Order.order_no}) }}">{{ '詳細を見る'|trans }}</a>
                                        <a class="ec-inlineBtn" href="{{ url('mypage_history', {'order_no': Order.order_no}) }}/#orderMails">{{ 'メール配信履歴'|trans }}</a>
                                    </p>
                                </div>
                            </div>
                            <div class="ec-historyRole__detail">
                                {% for OrderItem in Order.MergedProductOrderItems %}
                                    <div class="ec-imageGrid">
                                        <div class="ec-imageGrid__img">
                                            {% if OrderItem.Product is null %}
                                                <img src="{{ asset(''|no_image_product, 'save_image') }}"/>
                                            {% else %}
                                                <img src="{{ asset(OrderItem.Product.MainListImage|no_image_product, 'save_image') }}">
                                            {% endif %}
                                        </div>
                                        <div class="ec-imageGrid__content">
                                            <p class="ec-historyRole__detailTitle">{{ OrderItem.product_name }}</p>
                                            {% if OrderItem.class_category_name1 is not empty %}
                                                {{ OrderItem.class_category_name1 }}
                                            {% endif %}
                                            {% if OrderItem.class_category_name2 is not empty %}
                                                / {{ OrderItem.class_category_name2 }}
                                            {% endif %}
                                            <p class="ec-historyRole__detailPrice">{{ OrderItem.price_inc_tax|price }}
                                                × {{ OrderItem.quantity }}</p>
                                        </div>
                                    </div>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                {% endfor %}
                <div class="ec-pagerRole">
                    {% include "pager.twig" with {'pages': pagination.paginationData} %}
                </div>
            {% else %}
                <p class="ec-para-normal">{{ 'ご注文履歴はありません。'|trans }}</p>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}